<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tensorflow models &mdash; Pytwovision 1.0 documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Object detection (Recognition)" href="module_recognition.html" />
    <link rel="prev" title="Inputs and Outputs" href="module_input_output.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Pytwovision
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Modules</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="module_compute.html">Compute</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_datasets_loader.html">Datasets loader</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_image_process.html">Image process</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_input_output.html">Inputs and Outputs</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tensorflow models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#blocks">Blocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#layers">Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#models-manager">Models manager</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#how-to-use">How to use?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="module_recognition.html">Object detection (Recognition)</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_stereo.html">Stereo Vision</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_utils.html">Utilities</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Pytwovision</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Tensorflow models</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/module_models.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="tensorflow-models">
<h1>Tensorflow models<a class="headerlink" href="#tensorflow-models" title="Permalink to this headline">¶</a></h1>
<p>It is in charge of generating the layers and blocks that make up the architectures of the different neural networks using the tools offered by Tensorflow. Within models there are two submodules blocks and layers, the first one stores groups of layers, which can be Tensorflow’s own or customized layers which are found in the layers submodule.</p>
<div class="section" id="blocks">
<h2>Blocks<a class="headerlink" href="#blocks" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><span class="target" id="module-pytwovision.models.blocks.backbone_block"></span><dl class="class">
<dt id="pytwovision.models.blocks.backbone_block.BackboneStrategy">
<em class="property">class </em><code class="descclassname">pytwovision.models.blocks.backbone_block.</code><code class="descname">BackboneStrategy</code><a class="reference internal" href="_modules/pytwovision/models/blocks/backbone_block.html#BackboneStrategy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pytwovision.models.blocks.backbone_block.BackboneStrategy" title="Permalink to this definition">¶</a></dt>
<dd><p>The Strategy interface declares operations common to all supported versions
of some algorithm.</p>
<p>The Context uses this interface to call the algorithm defined by Concrete
Strategies.</p>
</dd></dl>

<dl class="class">
<dt id="pytwovision.models.blocks.backbone_block.darknet19_tiny">
<em class="property">class </em><code class="descclassname">pytwovision.models.blocks.backbone_block.</code><code class="descname">darknet19_tiny</code><a class="reference internal" href="_modules/pytwovision/models/blocks/backbone_block.html#darknet19_tiny"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pytwovision.models.blocks.backbone_block.darknet19_tiny" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="pytwovision.models.blocks.backbone_block.darknet19_tiny.build">
<code class="descname">build</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytwovision/models/blocks/backbone_block.html#darknet19_tiny.build"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pytwovision.models.blocks.backbone_block.darknet19_tiny.build" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a darknet19 tiny model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> – an input tensor that can be an image.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Two branches of darknet19 tiny.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pytwovision.models.blocks.backbone_block.darknet53">
<em class="property">class </em><code class="descclassname">pytwovision.models.blocks.backbone_block.</code><code class="descname">darknet53</code><a class="reference internal" href="_modules/pytwovision/models/blocks/backbone_block.html#darknet53"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pytwovision.models.blocks.backbone_block.darknet53" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="pytwovision.models.blocks.backbone_block.darknet53.build">
<code class="descname">build</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytwovision/models/blocks/backbone_block.html#darknet53.build"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pytwovision.models.blocks.backbone_block.darknet53.build" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a darknet53 model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> – an input tensor that can be an image.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">three branches of darknet53.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div></blockquote>
</div>
<div class="section" id="layers">
<h2>Layers<a class="headerlink" href="#layers" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><span class="target" id="module-pytwovision.models.layers.batch_normalization_layer"></span><dl class="class">
<dt id="pytwovision.models.layers.batch_normalization_layer.BatchNormalization">
<em class="property">class </em><code class="descclassname">pytwovision.models.layers.batch_normalization_layer.</code><code class="descname">BatchNormalization</code><span class="sig-paren">(</span><em>axis=-1</em>, <em>momentum=0.99</em>, <em>epsilon=0.001</em>, <em>center=True</em>, <em>scale=True</em>, <em>beta_initializer='zeros'</em>, <em>gamma_initializer='ones'</em>, <em>moving_mean_initializer='zeros'</em>, <em>moving_variance_initializer='ones'</em>, <em>beta_regularizer=None</em>, <em>gamma_regularizer=None</em>, <em>beta_constraint=None</em>, <em>gamma_constraint=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytwovision/models/layers/batch_normalization_layer.html#BatchNormalization"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pytwovision.models.layers.batch_normalization_layer.BatchNormalization" title="Permalink to this definition">¶</a></dt>
<dd><p>A modified batch normalization layer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> – input of the layer.</li>
<li><strong>training</strong> – it’s necessary to know when freeze the layer weights.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A batchNormalization layer.</p>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pytwovision.models.layers.batch_normalization_layer.BatchNormalization.call">
<code class="descname">call</code><span class="sig-paren">(</span><em>x</em>, <em>training=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytwovision/models/layers/batch_normalization_layer.html#BatchNormalization.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pytwovision.models.layers.batch_normalization_layer.BatchNormalization.call" title="Permalink to this definition">¶</a></dt>
<dd><p>This is where the layer’s logic lives.</p>
<p>The <cite>call()</cite> method may not create state (except in its first invocation,
wrapping the creation of variables or other resources in <cite>tf.init_scope()</cite>).
It is recommended to create state in <cite>__init__()</cite>, or the <cite>build()</cite> method
that is called automatically before <cite>call()</cite> executes the first time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>inputs</strong> – <p>Input tensor, or dict/list/tuple of input tensors.
The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</div></blockquote>
<ul>
<li>NumPy array or Python scalar values in <cite>inputs</cite> get cast as tensors.</li>
<li>Keras mask metadata is only collected from <cite>inputs</cite>.</li>
<li>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</li>
<li><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</li>
<li>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</li>
<li>The SavedModel input specification is generated using <cite>inputs</cite> only.</li>
<li>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</li>
</ul>
</li>
<li><strong>*args</strong> – Additional positional arguments. May contain tensors, although
this is not recommended, for the reasons above.</li>
<li><strong>**kwargs</strong> – <p>Additional keyword arguments. May contain tensors, although
this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div>whether the <cite>call</cite> is meant for training or inference.</div></blockquote>
<ul>
<li><cite>mask</cite>: Boolean input mask. If the layer’s <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask generated
for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come from a layer
that generated a corresponding mask, i.e. if it came from a Keras
layer with masking support).</li>
</ul>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A tensor or list/tuple of tensors.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<span class="target" id="module-pytwovision.models.layers.conv2d_bn_leaky_relu_layer"></span><dl class="function">
<dt id="pytwovision.models.layers.conv2d_bn_leaky_relu_layer.conv2d_bn_leaky_relu_layer">
<code class="descclassname">pytwovision.models.layers.conv2d_bn_leaky_relu_layer.</code><code class="descname">conv2d_bn_leaky_relu_layer</code><span class="sig-paren">(</span><em>input_layer</em>, <em>filters_shape</em>, <em>downsample=False</em>, <em>activate=True</em>, <em>bn=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytwovision/models/layers/conv2d_bn_leaky_relu_layer.html#conv2d_bn_leaky_relu_layer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pytwovision.models.layers.conv2d_bn_leaky_relu_layer.conv2d_bn_leaky_relu_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>A resnet block with depthwise separable convolutions to reduce the computational demand.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>input_layer</strong> – A tensor that works like input.</li>
<li><strong>filters_shape</strong> – An array or list or tuple that contains the shape of the filters which filters_shape[0] is kernel size for conv2d layer.</li>
<li><strong>downsample</strong> – a boolean to know when apply zero padding layer.</li>
<li><strong>activate</strong> – a boolean to know when apply leaky ReLu layer.</li>
<li><strong>bn</strong> – a boolean to know when apply a batch normalization layer.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A resnet block</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="module-pytwovision.models.layers.upsample_layer"></span><dl class="class">
<dt id="pytwovision.models.layers.upsample_layer.UpsampleLayer">
<em class="property">class </em><code class="descclassname">pytwovision.models.layers.upsample_layer.</code><code class="descname">UpsampleLayer</code><span class="sig-paren">(</span><em>trainable=True</em>, <em>name=None</em>, <em>dtype=None</em>, <em>dynamic=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytwovision/models/layers/upsample_layer.html#UpsampleLayer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pytwovision.models.layers.upsample_layer.UpsampleLayer" title="Permalink to this definition">¶</a></dt>
<dd><p>A layer for upsampling an image.</p>
<dl class="method">
<dt id="pytwovision.models.layers.upsample_layer.UpsampleLayer.call">
<code class="descname">call</code><span class="sig-paren">(</span><em>inputs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytwovision/models/layers/upsample_layer.html#UpsampleLayer.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pytwovision.models.layers.upsample_layer.UpsampleLayer.call" title="Permalink to this definition">¶</a></dt>
<dd><p>This is where the layer’s logic lives.</p>
<p>The <cite>call()</cite> method may not create state (except in its first invocation,
wrapping the creation of variables or other resources in <cite>tf.init_scope()</cite>).
It is recommended to create state in <cite>__init__()</cite>, or the <cite>build()</cite> method
that is called automatically before <cite>call()</cite> executes the first time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>inputs</strong> – <p>Input tensor, or dict/list/tuple of input tensors.
The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</div></blockquote>
<ul>
<li>NumPy array or Python scalar values in <cite>inputs</cite> get cast as tensors.</li>
<li>Keras mask metadata is only collected from <cite>inputs</cite>.</li>
<li>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</li>
<li><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</li>
<li>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</li>
<li>The SavedModel input specification is generated using <cite>inputs</cite> only.</li>
<li>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</li>
</ul>
</li>
<li><strong>*args</strong> – Additional positional arguments. May contain tensors, although
this is not recommended, for the reasons above.</li>
<li><strong>**kwargs</strong> – <p>Additional keyword arguments. May contain tensors, although
this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div>whether the <cite>call</cite> is meant for training or inference.</div></blockquote>
<ul>
<li><cite>mask</cite>: Boolean input mask. If the layer’s <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask generated
for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come from a layer
that generated a corresponding mask, i.e. if it came from a Keras
layer with masking support).</li>
</ul>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A tensor or list/tuple of tensors.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<span class="target" id="module-pytwovision.models.layers.residual_layer"></span><dl class="function">
<dt id="pytwovision.models.layers.residual_layer.residual_layer">
<code class="descclassname">pytwovision.models.layers.residual_layer.</code><code class="descname">residual_layer</code><span class="sig-paren">(</span><em>input_layer</em>, <em>input_channel</em>, <em>filter_num1</em>, <em>filter_num2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytwovision/models/layers/residual_layer.html#residual_layer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pytwovision.models.layers.residual_layer.residual_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>A residual block with two Convolutional-batch normalization-leakyReLu layers stacked one above other.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>input_layer</strong> – A tensor that works like input.</li>
<li><strong>input_channel</strong> – input layer dimensions.</li>
<li><strong>filter_num1</strong> – filter depth for the first convolutional-batch normalization-leakyRelu layer.</li>
<li><strong>filter_num2</strong> – filter depth for the second convolutional-batch normalization-leakyRelu layer.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A residual block.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div></blockquote>
</div>
<div class="section" id="models-manager">
<h2>Models manager<a class="headerlink" href="#models-manager" title="Permalink to this headline">¶</a></h2>
<p>Since the number of existing network architectures for recognition is enormous, the role of the model manager is to manage the use of network architectures by means of a mediator class.</p>
<blockquote>
<div><span class="target" id="module-pytwovision.models.models_manager"></span><dl class="class">
<dt id="pytwovision.models.models_manager.ModelManager">
<em class="property">class </em><code class="descclassname">pytwovision.models.models_manager.</code><code class="descname">ModelManager</code><a class="reference internal" href="_modules/pytwovision/models/models_manager.html#ModelManager"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pytwovision.models.models_manager.ModelManager" title="Permalink to this definition">¶</a></dt>
<dd><p>A selector of models that depends of which method is used.</p>
<dl class="attribute">
<dt id="pytwovision.models.models_manager.ModelManager.model1">
<code class="descname">model1</code><a class="headerlink" href="#pytwovision.models.models_manager.ModelManager.model1" title="Permalink to this definition">¶</a></dt>
<dd><p>an instance of Yolov3Model</p>
</dd></dl>

<dl class="attribute">
<dt id="pytwovision.models.models_manager.ModelManager.model2">
<code class="descname">model2</code><a class="headerlink" href="#pytwovision.models.models_manager.ModelManager.model2" title="Permalink to this definition">¶</a></dt>
<dd><p>an instance of Yolov3TinyModel</p>
</dd></dl>

<dl class="method">
<dt id="pytwovision.models.models_manager.ModelManager.build_yolov3">
<code class="descname">build_yolov3</code><span class="sig-paren">(</span><em>backbone</em>, <em>num_class</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytwovision/models/models_manager.html#ModelManager.build_yolov3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pytwovision.models.models_manager.ModelManager.build_yolov3" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the model to do YoloV3 based in darknet53.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>backbone</strong> – an object with a backbone network.</li>
<li><strong>num_class</strong> – an integer with the quantity of classes.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A list where the first one is used to predict large-sized objects, the second one is used to predict medium-sized objects, the third one is used to small objects and the last one is the input shape returned.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pytwovision.models.models_manager.ModelManager.build_yolov3_tiny">
<code class="descname">build_yolov3_tiny</code><span class="sig-paren">(</span><em>backbone</em>, <em>num_class</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytwovision/models/models_manager.html#ModelManager.build_yolov3_tiny"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pytwovision.models.models_manager.ModelManager.build_yolov3_tiny" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the model to do YoloV3 based in darknet19 tiny.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>backbone</strong> – an object with a backbone network.</li>
<li><strong>num_class</strong> – an integer with the quantity of classes.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A list where the first one is used to predict large-sized objects, the second one is used to predict medium-sized objects and the  last one is the input shape returned.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pytwovision.models.models_manager.ModelManagerInterface">
<em class="property">class </em><code class="descclassname">pytwovision.models.models_manager.</code><code class="descname">ModelManagerInterface</code><a class="reference internal" href="_modules/pytwovision/models/models_manager.html#ModelManagerInterface"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pytwovision.models.models_manager.ModelManagerInterface" title="Permalink to this definition">¶</a></dt>
<dd><p>An interface, which each method correspond with a network architecture.</p>
<dl class="staticmethod">
<dt id="pytwovision.models.models_manager.ModelManagerInterface.build_yolov3">
<em class="property">static </em><code class="descname">build_yolov3</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytwovision/models/models_manager.html#ModelManagerInterface.build_yolov3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pytwovision.models.models_manager.ModelManagerInterface.build_yolov3" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements yolov3.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="pytwovision.models.models_manager.ModelManagerInterface.build_yolov3_tiny">
<em class="property">static </em><code class="descname">build_yolov3_tiny</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytwovision/models/models_manager.html#ModelManagerInterface.build_yolov3_tiny"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pytwovision.models.models_manager.ModelManagerInterface.build_yolov3_tiny" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements yolov3 tiny</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-pytwovision.models.yolov3_model"></span><dl class="class">
<dt id="pytwovision.models.yolov3_model.BuildYoloV3">
<em class="property">class </em><code class="descclassname">pytwovision.models.yolov3_model.</code><code class="descname">BuildYoloV3</code><span class="sig-paren">(</span><em>backbone</em>, <em>num_class</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytwovision/models/yolov3_model.html#BuildYoloV3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pytwovision.models.yolov3_model.BuildYoloV3" title="Permalink to this definition">¶</a></dt>
<dd><p>Build YoloV3 model given a backbone.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>backbone</strong> – an object with a backbone network.</li>
<li><strong>num_class</strong> – an integer with the quantity of classes.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A list where the first one is used to predict large-sized objects,
the second one is used to predict medium-sized objects, the third one is used to small objects
and the last one is the input shape returned.</p>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pytwovision.models.yolov3_model.BuildYoloV3.call">
<code class="descname">call</code><span class="sig-paren">(</span><em>input_shape</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytwovision/models/yolov3_model.html#BuildYoloV3.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pytwovision.models.yolov3_model.BuildYoloV3.call" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls the model on new inputs and returns the outputs as tensors.</p>
<p>In this case <cite>call()</cite> just reapplies
all ops in the graph to the new inputs
(e.g. build a new computational graph from the provided inputs).</p>
<p>Note: This method should not be called directly. It is only meant to be
overridden when subclassing <cite>tf.keras.Model</cite>.
To call a model on an input, always use the <cite>__call__()</cite> method,
i.e. <cite>model(inputs)</cite>, which relies on the underlying <cite>call()</cite> method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>inputs</strong> – Input tensor, or dict/list/tuple of input tensors.</li>
<li><strong>training</strong> – Boolean or boolean scalar tensor, indicating whether to run
the <cite>Network</cite> in training mode or inference mode.</li>
<li><strong>mask</strong> – <p>A mask or list of masks. A mask can be either a boolean tensor or
None (no mask). For more details, check the guide</p>
<blockquote>
<div>[here](<a class="reference external" href="https://www.tensorflow.org/guide/keras/masking_and_padding">https://www.tensorflow.org/guide/keras/masking_and_padding</a>).</div></blockquote>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A tensor if there is a single output, or
a list of tensors if there are more than one outputs.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<span class="target" id="module-pytwovision.models.yolov3_tiny_model"></span><dl class="class">
<dt id="pytwovision.models.yolov3_tiny_model.BuildYoloV3Tiny">
<em class="property">class </em><code class="descclassname">pytwovision.models.yolov3_tiny_model.</code><code class="descname">BuildYoloV3Tiny</code><span class="sig-paren">(</span><em>backbone</em>, <em>num_class</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytwovision/models/yolov3_tiny_model.html#BuildYoloV3Tiny"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pytwovision.models.yolov3_tiny_model.BuildYoloV3Tiny" title="Permalink to this definition">¶</a></dt>
<dd><p>Build YoloV3 tiny model given a backbone</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong> – a string with the name of the model</li>
<li><strong>backbone</strong> – an object with a backbone network</li>
<li><strong>num_class</strong> – an integer with the quantity of classes</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A list where the first one is used to predict large-sized objects,
the second one is used to predict medium-sized objects and the  last one is the input shape returned.</p>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pytwovision.models.yolov3_tiny_model.BuildYoloV3Tiny.call">
<code class="descname">call</code><span class="sig-paren">(</span><em>input_shape</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytwovision/models/yolov3_tiny_model.html#BuildYoloV3Tiny.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pytwovision.models.yolov3_tiny_model.BuildYoloV3Tiny.call" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls the model on new inputs and returns the outputs as tensors.</p>
<p>In this case <cite>call()</cite> just reapplies
all ops in the graph to the new inputs
(e.g. build a new computational graph from the provided inputs).</p>
<p>Note: This method should not be called directly. It is only meant to be
overridden when subclassing <cite>tf.keras.Model</cite>.
To call a model on an input, always use the <cite>__call__()</cite> method,
i.e. <cite>model(inputs)</cite>, which relies on the underlying <cite>call()</cite> method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>inputs</strong> – Input tensor, or dict/list/tuple of input tensors.</li>
<li><strong>training</strong> – Boolean or boolean scalar tensor, indicating whether to run
the <cite>Network</cite> in training mode or inference mode.</li>
<li><strong>mask</strong> – <p>A mask or list of masks. A mask can be either a boolean tensor or
None (no mask). For more details, check the guide</p>
<blockquote>
<div>[here](<a class="reference external" href="https://www.tensorflow.org/guide/keras/masking_and_padding">https://www.tensorflow.org/guide/keras/masking_and_padding</a>).</div></blockquote>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A tensor if there is a single output, or
a list of tensors if there are more than one outputs.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div></blockquote>
<div class="section" id="how-to-use">
<h3>How to use?<a class="headerlink" href="#how-to-use" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pytwovision.models.models_manager</span> <span class="kn">import</span> <span class="n">ModelManager</span>
<span class="kn">from</span> <span class="nn">pytwovision.models.blocks.backbone_block</span> <span class="kn">import</span> <span class="n">BackboneBlock</span>
<span class="kn">from</span> <span class="nn">pytwovision.models.blocks.backbone_block</span> <span class="kn">import</span> <span class="n">darknet53</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
<span class="n">input_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">416</span><span class="p">,</span> <span class="mi">416</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="n">backbone_net</span> <span class="o">=</span> <span class="n">BackboneBlock</span><span class="p">(</span><span class="n">darknet53</span><span class="p">())</span>
<span class="n">model_manager</span> <span class="o">=</span> <span class="n">ModelManager</span><span class="p">()</span>
<span class="n">conv_sbbox</span><span class="p">,</span> <span class="n">conv_mbbox</span><span class="p">,</span> <span class="n">conv_lbbox</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">model_manager</span><span class="o">.</span><span class="n">build_yolov3</span><span class="p">(</span><span class="n">backbone_net</span><span class="p">,</span> <span class="mi">80</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="module_input_output.html" class="btn btn-neutral float-left" title="Inputs and Outputs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="module_recognition.html" class="btn btn-neutral float-right" title="Object detection (Recognition)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Guillermo Raven.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>